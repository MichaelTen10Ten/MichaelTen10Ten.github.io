<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag & Play Piano</title>
    <style>
        body { background: #1a1a1a; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; color: white; font-family: system-ui, sans-serif; overflow: hidden; }
        .piano-container { display: flex; padding: 20px; background: #333; border-radius: 10px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); user-select: none; }
        
        .key { width: 45px; height: 180px; background: white; border: 1px solid #ccc; border-radius: 0 0 5px 5px; cursor: pointer; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; padding-bottom: 10px; color: #333; font-size: 0.8rem; transition: background 0.1s; position: relative; }
        .key.black { width: 30px; height: 110px; background: #222; color: white; margin-left: -15px; margin-right: -15px; z-index: 2; border: none; }
        
        /* Interactive colors */
        .key:hover { background: #eee; }
        .key.black:hover { background: #444; }
        .key.active { background: #00d1ff !important; transform: translateY(2px); }
        .key.black.active { background: #0099ff !important; }
        
        .label { pointer-events: none; font-weight: bold; text-transform: uppercase; }
    </style>
</head>
<body oncontextmenu="return false;">

    <h2 style="margin-bottom: 5px;">Glissando Piano</h2>
    <p style="margin-bottom: 20px; color: #aaa;">Click and Drag across the keys to play!</p>

    <div class="piano-container" id="piano">
        <div class="key" data-note="261.63" data-bind='["z"]'><span class="label">Z</span></div>
        <div class="key black" data-note="277.18" data-bind='["s"]'><span class="label">S</span></div>
        <div class="key" data-note="293.66" data-bind='["x"]'><span class="label">X</span></div>
        <div class="key black" data-note="311.13" data-bind='["d"]'><span class="label">D</span></div>
        <div class="key" data-note="329.63" data-bind='["c"]'><span class="label">C</span></div>
        <div class="key" data-note="349.23" data-bind='["v"]'><span class="label">V</span></div>
        <div class="key black" data-note="369.99" data-bind='["g"]'><span class="label">G</span></div>
        <div class="key" data-note="392.00" data-bind='["b"]'><span class="label">B</span></div>
        <div class="key black" data-note="415.30" data-bind='["h"]'><span class="label">H</span></div>
        <div class="key" data-note="440.00" data-bind='["n"]'><span class="label">N</span></div>
        <div class="key black" data-note="466.16" data-bind='["j"]'><span class="label">J</span></div>
        <div class="key" data-note="493.88" data-bind='["m"]'><span class="label">M</span></div>

        <div class="key" data-note="523.25" data-bind='["q", ","]'><span class="label">Q ,</span></div>
        <div class="key black" data-note="554.37" data-bind='["2"]'><span class="label">2</span></div>
        <div class="key" data-note="587.33" data-bind='["w"]'><span class="label">W</span></div>
        <div class="key black" data-note="622.25" data-bind='["3"]'><span class="label">3</span></div>
        <div class="key" data-note="659.25" data-bind='["e"]'><span class="label">E</span></div>
        <div class="key" data-note="698.46" data-bind='["r"]'><span class="label">R</span></div>
        <div class="key black" data-note="739.99" data-bind='["5"]'><span class="label">5</span></div>
        <div class="key" data-note="783.99" data-bind='["t"]'><span class="label">T</span></div>
        <div class="key black" data-note="830.61" data-bind='["6"]'><span class="label">6</span></div>
        <div class="key" data-note="880.00" data-bind='["y"]'><span class="label">Y</span></div>
        <div class="key black" data-note="932.33" data-bind='["7"]'><span class="label">7</span></div>
        <div class="key" data-note="987.77" data-bind='["u"]'><span class="label">U</span></div>
        <div class="key" data-note="1046.50" data-bind='["i"]'><span class="label">I</span></div>
    </div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const pressedKeys = new Set();
    let isMouseDown = false;

    // Set mouse state globally
    window.addEventListener('mousedown', () => isMouseDown = true);
    window.addEventListener('mouseup', () => isMouseDown = false);

    function playNote(frequency, element) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();

        osc.type = 'triangle';
        osc.frequency.setValueAtTime(parseFloat(frequency), audioCtx.currentTime);

        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 1);

        osc.connect(gain);
        gain.connect(audioCtx.destination);

        osc.start();
        osc.stop(audioCtx.currentTime + 1);

        // Visual trigger
        element.classList.add('active');
        setTimeout(() => element.classList.remove('active'), 200);
    }

    // Key Element Helper
    function getKeyElement(key) {
        return Array.from(document.querySelectorAll('.key')).find(el => {
            const binds = JSON.parse(el.dataset.bind);
            return binds.includes(key.toLowerCase());
        });
    }

    // Drag and Click Logic
    document.querySelectorAll('.key').forEach(key => {
        // Initial Click
        key.addEventListener('mousedown', (e) => {
            playNote(key.dataset.note, key);
        });

        // Slide Over
        key.addEventListener('mouseenter', () => {
            if (isMouseDown) {
                playNote(key.dataset.note, key);
            }
        });
    });

    // Keyboard Logic
    window.addEventListener('keydown', (e) => {
        const keyChar = e.key.toLowerCase();
        if (pressedKeys.has(keyChar)) return;
        
        const el = getKeyElement(keyChar);
        if (el) {
            pressedKeys.add(keyChar);
            playNote(el.dataset.note, el);
        }
    });

    window.addEventListener('keyup', (e) => {
        pressedKeys.delete(e.key.toLowerCase());
    });
</script>
</body>
</html>