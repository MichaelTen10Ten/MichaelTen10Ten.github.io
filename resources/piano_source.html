<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extended 2-Octave Piano</title>
    <style>
        body { background: #1a1a1a; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; color: white; font-family: system-ui, sans-serif; }
        .piano-container { display: flex; padding: 20px; background: #333; border-radius: 10px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        
        .key { width: 45px; height: 180px; background: white; border: 1px solid #ccc; border-radius: 0 0 5px 5px; cursor: pointer; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; padding-bottom: 10px; color: #333; font-size: 0.8rem; transition: 0.1s; user-select: none; position: relative; }
        .key.black { width: 30px; height: 110px; background: #222; color: white; margin-left: -15px; margin-right: -15px; z-index: 2; border: none; }
        
        /* Highlight colors */
        .key:active, .key.active { background: #00d1ff !important; transform: translateY(2px); }
        .key.black:active, .key.black.active { background: #0099ff !important; }
        
        .label { pointer-events: none; font-weight: bold; text-transform: uppercase; }
        .sub-label { font-size: 0.6rem; color: #888; }
    </style>
</head>
<body>

    <h2 style="margin-bottom: 5px;">Extended JS Piano</h2>
    <p style="margin-bottom: 20px; color: #aaa;">Bottom: Z to M | Top: Q(,) to I</p>

    <div class="piano-container" id="piano">
        <div class="key" data-note="261.63" data-bind='["z"]'><span class="label">Z</span></div>
        <div class="key black" data-note="277.18" data-bind='["s"]'><span class="label">S</span></div>
        <div class="key" data-note="293.66" data-bind='["x"]'><span class="label">X</span></div>
        <div class="key black" data-note="311.13" data-bind='["d"]'><span class="label">D</span></div>
        <div class="key" data-note="329.63" data-bind='["c"]'><span class="label">C</span></div>
        <div class="key" data-note="349.23" data-bind='["v"]'><span class="label">V</span></div>
        <div class="key black" data-note="369.99" data-bind='["g"]'><span class="label">G</span></div>
        <div class="key" data-note="392.00" data-bind='["b"]'><span class="label">B</span></div>
        <div class="key black" data-note="415.30" data-bind='["h"]'><span class="label">H</span></div>
        <div class="key" data-note="440.00" data-bind='["n"]'><span class="label">N</span></div>
        <div class="key black" data-note="466.16" data-bind='["j"]'><span class="label">J</span></div>
        <div class="key" data-note="493.88" data-bind='["m"]'><span class="label">M</span></div>

        <div class="key" data-note="523.25" data-bind='["q", ","]'><span class="label">Q ,</span></div>
        <div class="key black" data-note="554.37" data-bind='["2"]'><span class="label">2</span></div>
        <div class="key" data-note="587.33" data-bind='["w"]'><span class="label">W</span></div>
        <div class="key black" data-note="622.25" data-bind='["3"]'><span class="label">3</span></div>
        <div class="key" data-note="659.25" data-bind='["e"]'><span class="label">E</span></div>
        <div class="key" data-note="698.46" data-bind='["r"]'><span class="label">R</span></div>
        <div class="key black" data-note="739.99" data-bind='["5"]'><span class="label">5</span></div>
        <div class="key" data-note="783.99" data-bind='["t"]'><span class="label">T</span></div>
        <div class="key black" data-note="830.61" data-bind='["6"]'><span class="label">6</span></div>
        <div class="key" data-note="880.00" data-bind='["y"]'><span class="label">Y</span></div>
        <div class="key black" data-note="932.33" data-bind='["7"]'><span class="label">7</span></div>
        <div class="key" data-note="987.77" data-bind='["u"]'><span class="label">U</span></div>
        
        <div class="key" data-note="1046.50" data-bind='["i"]'><span class="label">I</span><span class="sub-label">High C</span></div>
    </div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const pressedKeys = new Set();

    function playNote(frequency) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();

        osc.type = 'triangle';
        osc.frequency.setValueAtTime(parseFloat(frequency), audioCtx.currentTime);

        gain.gain.setValueAtTime(0.15, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 1.2);

        osc.connect(gain);
        gain.connect(audioCtx.destination);

        osc.start();
        osc.stop(audioCtx.currentTime + 1.2);
    }

    // Find key element by searching the JSON arrays in data-bind
    function getKeyElement(key) {
        return Array.from(document.querySelectorAll('.key')).find(el => {
            const binds = JSON.parse(el.dataset.bind);
            return binds.includes(key.toLowerCase());
        });
    }

    // Click support
    document.querySelectorAll('.key').forEach(key => {
        key.addEventListener('mousedown', () => playNote(key.dataset.note));
    });

    // Keyboard support
    window.addEventListener('keydown', (e) => {
        const key = e.key.toLowerCase();
        if (pressedKeys.has(key)) return;

        const el = getKeyElement(key);
        if (el) {
            pressedKeys.add(key);
            el.classList.add('active');
            playNote(el.dataset.note);
        }
    });

    window.addEventListener('keyup', (e) => {
        const key = e.key.toLowerCase();
        pressedKeys.delete(key);
        const el = getKeyElement(key);
        if (el) el.classList.remove('active');
    });
</script>
</body>
</html>